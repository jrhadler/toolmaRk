<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tests for Same-Source of Toolmarks • toolmaRk</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Tests for Same-Source of Toolmarks">
<meta property="og:description" content='Implements two tests for same-source of toolmarks. The chumbley_non_random() test follows the paper "An Improved Version of a Tool Mark Comparison Algorithm" by Hadler and Morris (2017) &lt;doi:10.1111/1556-4029.13640&gt;. This is an extension of the Chumbley score as previously described in "Validation of Tool Mark Comparisons Obtained Using a Quantitative, Comparative, Statistical Algorithm" by Chumbley et al (2010) &lt;doi:10.1111/j.1556-4029.2010.01424.x&gt;. fixed_width_no_modeling() is based on correlation measures in a diamond shaped area of the toolmark as described in Hadler (2017).'>
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">toolmaRk</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="were-two-striation-marks-made-by-the-same-tool-or-by-different-tools" class="section level2">
<h2 class="hasAnchor">
<a href="#were-two-striation-marks-made-by-the-same-tool-or-by-different-tools" class="anchor"></a>Were two striation marks made by the same tool or by different tools?</h2>
<p>The R package toolmaRk provides a range of statistical tests for that.</p>
<p><a href="https://cran.r-project.org/package=toolmaRk"><img src="http://www.r-pkg.org/badges/version/toolmaRk" alt="CRAN Status"></a> <a href="http://www.r-pkg.org/pkg/toolmaRk"><img src="http://cranlogs.r-pkg.org/badges/toolmaRk" alt="CRAN RStudio mirror downloads"></a> <a href="https://travis-ci.org/jrhadler/toolmaRk"><img src="https://travis-ci.org/jrhadler/toolmaRk.svg?branch=master" alt="Travis-CI Build Status"></a></p>
</div>
<div id="installation" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1></div>
<p><code>toolmaRk</code> is available from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"toolmaRk"</span>)</a></code></pre></div>
<p>The development version of <code>toolmaRk</code> is available from Github:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb2-2" title="2">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"jrhadler/toolmaRk"</span>, <span class="dt">build_vignettes =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h1>
<p>Load the library</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(toolmaRk)</a></code></pre></div>
<div id="load-a-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#load-a-dataset" class="anchor"></a>Load a dataset</h2>
<p>The <code>ameslab</code> dataset provided with the package is data collected by Prof. Scott Chumbley, Mr. Stephen Davis, Ms. Taylor Grieve, Mr. Ryan Spotts, and Dr. Jeremy Hadler (Ames Laboratory, US DoE, Contract No. DE-Ac02-07CH11358). The data consists of 16 profiles from 7 different tool (T2, T4, T6, T7, T9, T10, and T11). Profiles from the same tool are considered to be same-source, profiles from different tools are different-source marks.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(<span class="st">"ameslab"</span>)</a></code></pre></div>
</div>
<div id="a-first-look-at-toolmark-profiles" class="section level2">
<h2 class="hasAnchor">
<a href="#a-first-look-at-toolmark-profiles" class="anchor"></a>A first look at toolmark profiles</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb5-3" title="3">ameslab<span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(ameslab)</a>
<a class="sourceLine" id="cb5-4" title="4">ameslab &lt;-<span class="st"> </span>ameslab <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb5-6" title="6">    <span class="dt">data =</span> profile <span class="op">%&gt;%</span><span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span>(<span class="dt">.f =</span> <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb5-7" title="7">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(x) &lt;-<span class="st"> "profile"</span></a>
<a class="sourceLine" id="cb5-8" title="8">      x<span class="op">$</span>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(x)</a>
<a class="sourceLine" id="cb5-9" title="9">      x</a>
<a class="sourceLine" id="cb5-10" title="10">  }))</a>
<a class="sourceLine" id="cb5-11" title="11"></a>
<a class="sourceLine" id="cb5-12" title="12">ameslab_long &lt;-<span class="st"> </span>ameslab <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span>(data) </a>
<a class="sourceLine" id="cb5-13" title="13"></a>
<a class="sourceLine" id="cb5-14" title="14">ameslab_long <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(ID<span class="op">==</span><span class="st">"T10"</span>, side <span class="op">==</span><span class="st"> "A"</span>, angle<span class="op">==</span><span class="dv">50</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> profile)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">factor</a></span>(id))) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">name=</span><span class="st">"Toolmark"</span>, <span class="dt">type=</span><span class="st">"qual"</span>)</a></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>The profiles of the two tools look very similar. We can now test for same-sourceness.</p>
</div>
<div id="testing-same-sourceness" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-same-sourceness" class="anchor"></a>Testing same-sourceness</h2>
<p>The tests in <code>toolmaRk</code> are set up using the null hypothesis of different source, i.e. the basic assumption is that two profiles were made by different tools. The alternative hypothesis is therefore ‘same tool’.</p>
<div id="non-random-chumbley" class="section level3">
<h3 class="hasAnchor">
<a href="#non-random-chumbley" class="anchor"></a>non-random Chumbley</h3>
<p>Using a non-random Chumbley U statistic (Hadler and Morris, 2017), we find strong evidence against different source:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="reference/chumbley_non_random.html">chumbley_non_random</a></span>(</a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(ameslab<span class="op">$</span>profile[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,]), </a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(ameslab<span class="op">$</span>profile[[<span class="dv">2</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">2000</span>,]))</a></code></pre></div>
<pre><code>## $same_shift_n
## [1] 28
## 
## $diff_shift_n
## [1] 24
## 
## $U
## [1] 3.340715
## 
## $p_value
## [1] 0.0004178146</code></pre>
<p>The p-value of 0.0004 is very indicative of rejecting different-source (null hypothesis) in favor of same-source (alternative hypothesis).</p>
</div>
<div id="distancethreshold-test-for-toolmarks" class="section level3">
<h3 class="hasAnchor">
<a href="#distancethreshold-test-for-toolmarks" class="anchor"></a>Distance/threshold test for toolmarks</h3>
<p>Both the distance and the threshold test for toolmarks (Hadler 2016) provide similar evidence:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">res11 &lt;-<span class="st"> </span><span class="kw"><a href="reference/fixed_width_no_modeling.html">fixed_width_no_modeling</a></span>(</a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(ameslab<span class="op">$</span>profile[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">1250</span>,]),</a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(ameslab<span class="op">$</span>profile[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">1250</span>,]), <span class="dt">M =</span> <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb8-4" title="4">res11<span class="op">$</span>dist_pval</a></code></pre></div>
<pre><code>## [1] 0.0025</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">res11<span class="op">$</span>thresh_pval</a></code></pre></div>
<pre><code>## [1] 0.0025</code></pre>
<p>The p-values again indicate to reject the null hypothesis of same-sourceness in favor of the alternative of different sourceness.</p>
</div>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<ul>
<li>Hadler J. R. and Morris M.D., An Improved Version of a Tool Mark Comparison Algorithm. J Forensic Sci, 2017, vol. 63 (3), 2 pp. 849-855. <a href="http://doi.wiley.com/10.1111/1556-4029.13640" class="uri">http://doi.wiley.com/10.1111/1556-4029.13640</a>
</li>
<li>Hadler, J. R., Forensic tool mark comparisons: Tests for the null hypothesis of different sources, Graduate Theses and Dissertations, Iowa State University, 2017, <a href="https://lib.dr.iastate.edu/etd/15312/" class="uri">https://lib.dr.iastate.edu/etd/15312/</a>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=toolmaRk">https://​cloud.r-project.org/​package=toolmaRk</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jeremy Hadler <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jeremy Hadler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
